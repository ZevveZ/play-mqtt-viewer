<!DOCTYPE html>
<html>

<head>
    <link href="/static/vendors/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="/static/vendors/sb-admin/css/sb-admin.css" rel="stylesheet">
    <link href="/static/vendors/datatables/media/css/jquery.dataTables.min.css " rel="stylesheet">
    <link href="/static/vendors/c3/c3.min.css" rel="stylesheet">
    <link href="/static/vendors/whhg-font/css/whhg.css" rel="stylesheet">
    <link href="/static/vendors/flameGraph/d4.flameGraph.css" rel="stylesheet">

    <link href="/static/css/lepv.css" rel="stylesheet">
</head>

<body>


    <!--cpu-stat-donut-->
    <div class="col-md-6">
        <div id="container-div-cpu-stat-donut" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i> CPU Stat: Overall</div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>


    <!--cpu-stat-idle-->
    <div class="col-md-12">
        <div id="container-div-cpu-stat-idle" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i> CPU Stat: Idle</div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>


    <!--cpu-stat-user-group-->
    <div class="col-md-12">
        <div id="container-div-cpu-stat-user-group" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i> CPU Stat: User + System + Nice</div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>


    <!--cpu-stat-irqGroup-->
    <div class="col-md-12">
        <div id="container-div-cpu-stat-irqGroup" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                <span class="spanTitle">{{ languages.cpuIrqGroupChartTitle }}</span>
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>


    <!--cpu-stat-irq-->
    <div class="col-md-12">
        <div id="container-div-cpu-stat-irq" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                <span class="spanTitle">{{ languages.cpuIrqChartTitle }}</span>
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>


    <!--cpu-stat-nettxIrq-->
    <div class="col-md-12">
        <div id="container-div-cpu-stat-nettxIrq" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                <span class="spanTitle">{{ languages.cpuNettxIrqChartTitle }}</span>
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>

    <!--cpu-stat-netrxIrq-->
    <div class="col-md-12">
        <div id="container-div-cpu-stat-netrxIrq" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                <span class="spanTitle">{{ languages.cpuNettxIrqChartTitle }}</span>
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        <div id="container-div-cpu-stat-taskletIrq" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                <span class="spanTitle">{{ languages.cpuNettxIrqChartTitle }}</span>
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        <div id="container-div-cpu-stat-hrtimerIrq" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                <span class="spanTitle">{{ languages.cpuNettxIrqChartTitle }}</span>
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>



    <div class="col-md-12">
        <div id="container-div-cpu-avgload" class="card mb-3">
            <div class="card-header">
                <i class="icon-cpu-processor"></i>
                {% if config == 'debug' %}
                <span class="spanTitle">{{ languages.averageLoadChartTitle }} - [GetProcLoadavg]</span>
                {% else %}
                <span class="spanTitle" fullTitle="{{ languages.averageLoadChartTitleFull }}" shortTitle="{{ languages.averageLoadChartTitle }}">{{ languages.averageLoadChartTitle }}</span>
                {% endif %}
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        <div class="row">
            <div class="col-md-4">
                <div id="container-div-memory-free-pss-stat" class="card mb-3">
                    <div class="card-header">
                        {% if config == 'debug' %}
                        <i class="icon-ram"></i> {{ languages.memoryPssAgainstTotalChartTitle }} -[GetCmdProcrank] {% else %}
                        <i class="icon-ram"></i> {{ languages.memoryPssAgainstTotalChartTitle }} {% endif %}
                    </div>
                    <div class="card-body">
                        <div class="chart-panel"></div>
                    </div>
                    <div class="card-footer small text-muted" hidden>
                        <i class="fa fa-bell" aria-hidden="true"> </i>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div id="container-div-memory-pss-stat" class="card mb-3">
                    <div class="card-header">
                        {% if config == 'debug' %}
                        <i class="icon-ram"></i> {{ languages.memoryPssDonutChartTitle }} -[GetCmdProcrank] {% else %}
                        <i class="icon-ram"></i> {{ languages.memoryPssDonutChartTitle }} {% endif %}
                    </div>
                    <div class="card-body">
                        <div class="chart-panel"></div>
                    </div>
                    <div class="card-footer small text-muted" hidden>
                        <i class="fa fa-bell" aria-hidden="true"> </i>
                    </div>
                </div>
            </div>

        </div>

    </div>


    <div class="col-md-12">
        <div id='container-div-IOCharts' class="card mb-3">
            <div class="card-header">
                {% if config == 'debug' %}
                <i class="icon-syncalt"></i> {{ languages.ioChartTitle }} -[GetCmdIostat] {% else %}
                <i class="icon-syncalt"></i> {{ languages.ioChartTitle }} {% endif %}
            </div>
            <div class="card-body">
                <div class="chart-panel"></div>
            </div>
            <div class="card-footer small text-muted" hidden>
                <i class="fa fa-bell" aria-hidden="true"> </i>
            </div>
        </div>
    </div>

    <script src="/static/vendors/jquery/jquery.min.js"></script>
    <script src="/static/vendors/popper/popper.min.js"></script>
    <script src="/static/vendors/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/vendors/jquery-easing/jquery.easing.min.js"></script>
    <script src="/static/vendors/sb-admin/js/sb-admin.min.js"></script>
    <script src="/static/vendors/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/static/vendors/c3/d3.min.js" charset="utf-8"></script>
    <script src="/static/vendors/c3/c3.min.js"></script>
    <script src="/static/vendors/null-io/null-io-slim.js"></script>
    <script src="/static/vendors/flameGraph/d4.js"></script>
    <script src="/static/vendors/flameGraph/d4.tip.js"></script>
    <script src="/static/vendors/flameGraph/d4.flameGraph.min.js"></script>

    <script src="/static/js/charts/lepvChart.js"></script>
    <script src="/static/js/charts/lepvGaugeChart.js"></script>

    <script src="/static/js/charts/cpu/cpuStatDonutChart.js"></script>
    <script src="/static/js/charts/cpu/cpuStatIdleChart.js"></script>
    <script src="/static/js/charts/cpu/cpuStatIrqGroupChart.js"></script>
    <script src="/static/js/charts/cpu/cpuStatUserGroupChart.js"></script>

    <script src="/static/js/charts/cpu/cpuGauguChart.js"></script>
    <script src="/static/js/charts/cpu/cpuAvgloadChart.js"></script>

    <script src="/static/js/charts/cpu/cpuIrqChart.js"></script>
    <script src="/static/js/charts/cpu/cpuSoftIrqChart.js"></script>
    <script src="/static/js/charts/cpu/cpuTopTable.js"></script>

    <script src="/static/js/charts/memory/memoryGauguChart.js"></script>
    <script src="/static/js/charts/memory/memoryChart.js"></script>
    <script src="/static/js/charts/memory/memoryStatTable.js"></script>
    <script src="/static/js/charts/memory/procrankFreeVsPieChart.js"></script>
    <script src="/static/js/charts/memory/procrankPssPieChart.js"></script>

    <script src="/static/js/charts/io/ioStatChart.js"></script>
    <script src="/static/js/charts/io/ioGauguChart.js"></script>
    <script src="/static/js/charts/io/ioTopTable.js"></script>

    <script src="/static/js/charts/perf/perfCpuTable.js"></script>

    <script src="/static/js/charts/perf/perfFlameGraph.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>

    <script>
        var cpuStatDonutChart = new CpuStatDonutChart("container-div-cpu-stat-donut", null, null);
        var cpuStatIdleChart = new CpuStatIdleChart("container-div-cpu-stat-idle", null, null);
        var cpuStatUserGroupChart = new CpuStatUserGroupChart("container-div-cpu-stat-user-group", null, null);
        var cpuIrqGroupChart = new CpuIrqGroupChart("container-div-cpu-stat-irqGroup", null, null);

        var cpuIrqChart = new CpuIrqChart("container-div-cpu-stat-irq", null, null);
        var cpuNettxIrqChart = new CpuSoftIrqChart("container-div-cpu-stat-nettxIrq", null, null, 'NET_TX');
        var cpuNetrxIrqChart = new CpuSoftIrqChart("container-div-cpu-stat-netrxIrq", null, null, 'NET_RX');
        var cputaskletIrqChart = new CpuSoftIrqChart("container-div-cpu-stat-taskletIrq", null, null, 'TASKLET');
        var cpuhrtimerIrqChart = new CpuSoftIrqChart("container-div-cpu-stat-hrtimerIrq", null, null, 'HRTIMER');
        var cpuAvgloadChart = new CpuAvgLoadChart("container-div-cpu-avgload", null, null);
        var memoryFreePssStatChart = new ProcrankFreeVsPieChart('container-div-memory-free-pss-stat', null, null);
        var memoryPssStatChart = new ProcrankPssPieChart('container-div-memory-pss-stat', null, null);
        var ioStatChart = new IOStatChart('container-div-IOCharts', null, null);

        client = new Paho.MQTT.Client('222.201.144.236', 8001, '123');
        client.onMessageArrived = onMessageArrived;
        client.connect({ userName: 'zev', password: 'hellozev', onSuccess: onConnect, useSSL:true});

        function onConnect() {
            console.log('connected');
            client.subscribe('/1/monitor/+');
        }
        function onMessageArrived(message) {
            console.log(message.destinationName);
            res = JSON.parse(message.payloadString);
            if (message.destinationName == '/1/monitor/cpu_stat') {
                cpuStatDonutChart.updateChartData(res);
                cpuStatIdleChart.updateChartData(res);
                cpuStatUserGroupChart.updateChartData(res);
                cpuIrqGroupChart.updateChartData(res);
                cpuIrqChart.updateChartData(res);
            }else if (message.destinationName == '/1/monitor/cpu_softirq') {
                cpuNettxIrqChart.updateChartData(res);
                cpuNetrxIrqChart.updateChartData(res);
                cputaskletIrqChart.updateChartData(res);
                cpuhrtimerIrqChart.updateChartData(res);
            }else if(message.destinationName == '/1/monitor/cpu_avgload'){
                cpuAvgloadChart.updateChartData(res);
            }else if(message.destinationName == '/1/monitor/memory_procrank'){
                memoryFreePssStatChart.updateChartData(res);
                memoryPssStatChart.updateChartData(res);
            }else if(message.destinationName == '/1/monitor/io_status'){
                ioStatChart.updateChartData(res);
            }
            
        }


    </script>
</body>

</html>
